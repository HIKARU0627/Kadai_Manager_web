# AI機能の使い方ガイド

## 🚀 セットアップ

### 1. APIキーの取得

AI機能を使用するには、少なくとも1つのAIプロバイダーのAPIキーが必要です。

#### OpenAI GPT-4
1. https://platform.openai.com/api-keys にアクセス
2. アカウントを作成またはログイン
3. "Create new secret key" をクリック
4. APIキーをコピー（`sk-...` で始まる文字列）

#### Anthropic Claude
1. https://console.anthropic.com/settings/keys にアクセス
2. アカウントを作成またはログイン
3. "Create Key" をクリック
4. APIキーをコピー（`sk-ant-...` で始まる文字列）

#### Google Gemini
1. https://makersuite.google.com/app/apikey にアクセス
2. Googleアカウントでログイン
3. "Create API Key" をクリック
4. APIキーをコピー

### 2. 環境変数の設定

プロジェクトのルートディレクトリに `.env` ファイルを作成し、以下を追加：

```env
# 少なくとも1つのAPIキーを設定してください
OPENAI_API_KEY=sk-your-openai-key-here
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key-here
GEMINI_API_KEY=your-gemini-key-here
```

### 3. 開発サーバーの再起動

環境変数を変更した後は、開発サーバーを再起動してください：

```bash
# Ctrl+C で現在のサーバーを停止
npm run dev
```

## 📖 使い方

### 基本的な使い方

1. **ファイル管理ページにアクセス**
   - サイドバーから「ファイル」をクリック
   - または直接 http://localhost:3000/files にアクセス

2. **ファイルをアップロード**（まだファイルがない場合）
   - 課題ページ、メモページ、または科目ページからファイルをアップロード
   - テキストファイル（.txt、.md、.py、.jsなど）を推奨

3. **AI機能を実行**
   - ファイル一覧で、処理したいファイルの横にある**紫色の✨ボタン**をクリック
   - AIプロバイダーを選択（OpenAI / Claude / Gemini）
   - 操作を選択：
     - **📝 要約生成**: 長い文書を簡潔に要約
     - **💻 コード生成**: 課題の要件からコードを自動生成
     - **🔍 詳細分析**: ファイル内容を深く分析
   - 「AI処理を実行」ボタンをクリック

4. **結果を確認**
   - 処理が完了すると、結果がテキストエリアに表示されます
   - 「コピー」ボタンで結果をクリップボードにコピー可能

### コード生成の使い方

1. 課題の要件が書かれたテキストファイルを用意
2. AI機能ダイアログで「コード生成」を選択
3. プログラミング言語を選択（Python、JavaScript、Java など）
4. 実行すると、以下を含むコードが生成されます：
   - 日本語のコメント
   - エラーハンドリング
   - テストケース例
   - 使用方法の説明

## 🎯 使用例

### 例1: 講義資料の要約

**ファイル**: `lecture_notes.txt`（5000文字の講義ノート）

**操作**: 要約生成

**結果**:
```
概要:
本講義では、Pythonのオブジェクト指向プログラミングについて学びました...

主要なポイント:
- クラスとインスタンスの概念
- 継承とポリモーフィズム
- カプセル化の重要性
...
```

### 例2: プログラミング課題からコード生成

**ファイル**: `assignment.txt`
```
課題: Pythonで簡単な計算機を作成してください
要件: 加算、減算、乗算、除算をサポート
```

**操作**: コード生成（Python）

**結果**: 完全に動作する計算機プログラム（コメント付き）

## ⚠️ トラブルシューティング

### エラー: "APIキーが設定されていません"

**原因**: 選択したAIプロバイダーのAPIキーが `.env` ファイルに設定されていません。

**解決方法**:
1. `.env` ファイルに該当するAPIキーを追加
2. 開発サーバーを再起動（`Ctrl+C` → `npm run dev`）

### エラー: "ファイルの読み取りに失敗しました"

**原因**:
- ファイルがテキスト形式ではない（画像、PDFなど）
- ファイルが存在しない
- ファイルが大きすぎる（200KB制限）

**解決方法**:
- テキストファイル（.txt、.md、.py、.jsなど）を使用
- ファイルサイズを200KB以下に
- ファイルが正しくアップロードされているか確認

### エラー: "500 Internal Server Error"

**原因**:
- APIキーが無効
- ネットワークエラー
- AIプロバイダーのサービス障害

**解決方法**:
1. ブラウザの開発者ツール（F12）でコンソールを確認
2. APIキーが正しいか確認
3. 別のAIプロバイダーを試す
4. しばらく時間を置いてから再試行

## 💰 コスト管理

AI機能の使用にはコストがかかります：

| プロバイダー | 入力トークン単価 | 出力トークン単価 | 推定コスト（1リクエスト） |
|------------|--------------|--------------|---------------------|
| OpenAI GPT-4 | $0.01/1K | $0.03/1K | $0.02-0.10 |
| Claude 3.5 | $0.003/1K | $0.015/1K | $0.01-0.05 |
| Gemini Pro | $0.001/1K | $0.002/1K | $0.005-0.02 |

**節約のヒント**:
- 短いファイルで試してから長いファイルを処理
- 必要な機能だけを使用
- 使用量をモニタリング（各プロバイダーのダッシュボードで確認）

## 🔒 セキュリティとプライバシー

- APIキーは **絶対に** Gitにコミットしないでください
- `.env` ファイルは `.gitignore` に含まれています
- アップロードされたファイルはあなたのアカウントでのみアクセス可能
- AI処理時、ファイル内容はAIプロバイダーに送信されます
- 機密情報を含むファイルの処理には注意してください

## 🛠️ 高度な使い方

### 複数のプロバイダーを比較

同じファイルを複数のAIプロバイダーで処理して、結果を比較できます：

1. OpenAIで要約を生成
2. 結果をメモ
3. Claudeで同じファイルを要約
4. 結果を比較

各プロバイダーの特徴:
- **OpenAI**: バランスが良く、コード生成に強い
- **Claude**: 長文処理と日本語に強い
- **Gemini**: コストパフォーマンスが良い

### カスタムプロンプト（今後の機能）

将来的には、独自のプロンプトを指定できる機能を追加予定です。

## 📞 サポート

問題が解決しない場合：
1. GitHubのIssueを確認: https://github.com/your-repo/issues
2. 新しいIssueを作成して質問
